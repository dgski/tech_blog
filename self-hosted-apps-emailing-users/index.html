<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Self-Hosted Apps: Programmatic Email - Tech @ DG</title><meta name="description" content="I host a few small web projects using CapRover, a simple web-based&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://tech.davidgorski.ca/self-hosted-apps-emailing-users/"><link rel="alternate" type="application/atom+xml" href="https://tech.davidgorski.ca/feed.xml"><link rel="alternate" type="application/json" href="https://tech.davidgorski.ca/feed.json"><meta property="og:title" content="Self-Hosted Apps: Programmatic Email"><meta property="og:site_name" content="Tech @ DG"><meta property="og:description" content="I host a few small web projects using CapRover, a simple web-based&hellip;"><meta property="og:url" content="https://tech.davidgorski.ca/self-hosted-apps-emailing-users/"><meta property="og:type" content="article"><link rel="preload" href="https://tech.davidgorski.ca/assets/dynamic/fonts/publicsans/publicsans.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://tech.davidgorski.ca/assets/css/style.css?v=1501a03667953b81505b3bfe44bcde3f"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://tech.davidgorski.ca/self-hosted-apps-emailing-users/"},"headline":"Self-Hosted Apps: Programmatic Email","datePublished":"2024-03-25T12:56","dateModified":"2024-03-25T12:56","description":"I host a few small web projects using CapRover, a simple web-based&hellip;","author":{"@type":"Person","name":"David Gorski","url":"https://tech.davidgorski.ca/authors/david-gorski/"},"publisher":{"@type":"Organization","name":"David Gorski"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><script async defer="defer" data-website-id="f50301b5-5202-4a86-9509-d0a3ed6ed290" src="https://analytics.xantasoft.com/umami.js"></script></head><body><div class="content"><div class="left-bar"><div class="left-bar__inner"><header class="header"><a class="logo" href="https://tech.davidgorski.ca/">Tech @ DG</a></header></div></div><main class="main"><article class="post"><div class="post__meta post__meta--attop"><div class="post__meta--attop__inner"><div class="post__maintag"><svg width="20" height="20" aria-hidden="true" focusable="false"><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#tag"/></svg> Published in <a href="https://tech.davidgorski.ca/tags/docker/" class="metadata__maintag">docker</a></div></div></div><div class="main__inner"><div class="post__meta"><div class="post__author"><div><a href="https://tech.davidgorski.ca/authors/david-gorski/" class="post__author__name">David Gorski</a></div></div><div class="post__date"><time datetime="2024-03-25T12:56">Mar 25, 2024</time></div></div><header class="post__header"><h1 class="post__title">Self-Hosted Apps: Programmatic Email</h1></header><div class="post__entry"><p>I host a few small web projects using <a href="https://caprover.com/">CapRover</a>, a simple web-based container orchestration framework built upon Docker Services. For non-critical hobby apps, it is perfect. I simply run CapRover on a virtual private server (VPS) with DigitalOcean and containerize all my running applications; forgoing all systemd setup and dependency installation.</p><p>One feature that I needed was programmatic email. This was necessary for welcome emails, password resets and notifications. CapRover, being a simple docker service orchestrator couldn’t help me. So I needed to find my own solution.</p><p>Before organizing this self-hosted system, I was using MailGun and it was working well for me, but I didn’t want to ‘hardcode’ reliance on external platforms within my apps. I wanted to be as platform-agnostic as possible. At the same time, I knew I couldn’t directly send emails from my VPS (Virtual Private Server), as that would be complex to set up and prone to be marked as spam.</p><p>I decided that what I needed was an internal service that would be queried via an agnostic interface (JSON over HTTP) which would then send the mail via SMTP, another agnostic interface. This would allow all applications to send emails without needing any ‘emailing code dependencies’ and also allow me to change the actual SMTP server as desired for flexibility in just one place.</p><p>I implemented this <code>mailservice</code> in less than 150 lines of go and used the following schema for the JSON request:</p><pre><code class="language-go">type AttachmentInfo struct {
    Name           string `json:&quot;name&quot;`
    Base64Contents string `json:&quot;base64contents&quot;`
}

type MailSendRequest struct {
    FromAddress string           `json:&quot;from_address&quot;`
    ToAddress   string           `json:&quot;to_address&quot;`
    Subject     string           `json:&quot;subject&quot;`
    Body        string           `json:&quot;body&quot;`
    ContentType string           `json:&quot;content_type&quot;`
    Attachments []AttachmentInfo `json:&quot;attachments&quot;`
}
</code></pre><p>As far as the SMTP server, I used Amazon SES for it’s low cost and reliability. Whenever I wanted to send email from a new domain, I had to verify I owned it via the Amazon web panel.</p><p>Now it is easy for me to add low-cost emailing capabilities to any new project via this unexposed service running within Docker; it would be as easy as an HTTP request. No libraries needed. Moving my whole deployment to a different orchestration platform would be painless as well as it is all containerized.</p></div><footer class="post__footer"><div class="post__last-updated">This article was updated on <time datetime="2024-03-25T12:56">Mar 25, 2024</time></div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftech.davidgorski.ca%2Fself-hosted-apps-emailing-users%2F" class="js-share facebook tltp tltp--top" aria-label="Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Ftech.davidgorski.ca%2Fself-hosted-apps-emailing-users%2F&amp;via=Tech%20%40%20DG&amp;text=Self-Hosted%20Apps%3A%20Programmatic%20Email" class="js-share twitter tltp tltp--top" aria-label="Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Ftech.davidgorski.ca%2Fself-hosted-apps-emailing-users%2F&amp;media=undefined&amp;description=Self-Hosted%20Apps%3A%20Programmatic%20Email" class="js-share pinterest tltp tltp--top" aria-label="Pinterest" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftech.davidgorski.ca%2Fself-hosted-apps-emailing-users%2F" class="js-share linkedin tltp tltp--top" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span></a></div></footer></div></article></main><div class="right-bar"><div class="right-bar__inner"><div class="sidebar"><section class="box promo"><h3 class="box__title">New Book Available Now!</h3><img src="/media/files/ilp.png"><p>Introduction To Low Latency Programming: Learn The Fundamental Ideas Behind High-Performance C++ Code</p><br><a href="https://a.co/d/0U6KOfb"><button>Buy On Amazon</button></a><br><br><br><h3 class="box__title">Newsletter Subscription Options</h3><ul><li><a href="https://tech.davidgorski.ca/feed.xml">RSS</a></li><li><a href="https://techatdg.substack.com">Email Via Substack</a></li></ul></section><div class="box follow"><a href="https://twitter.com/thedavidgorski" class="tltp tltp--top" aria-label="Twitter"><svg><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://www.linkedin.com/in/dgski/" class="tltp tltp--top" aria-label="LinkedIn"><svg><use xlink:href="https://tech.davidgorski.ca/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span></a></div><div class="box copyright">© David Gorski, 2024</div></div></div></div></div><script defer="defer" src="https://tech.davidgorski.ca/assets/js/scripts.min.js?v=12d8fcd46db8fdc7af6797ec26849875"></script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://tech.davidgorski.ca/assets/js/quicklink.umd.js?v=a52ee49fe4afff274f8c30fe880ddc13"></script><script>window.addEventListener('load', () =>{
      quicklink.listen();
      });</script></body></html>